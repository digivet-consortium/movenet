<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="What the package does (one paragraph).">
<title>What the Package Does (One Line, Title Case) • movenet</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">movenet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0-1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/movenet.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="movenet">Movenet<a class="anchor" aria-label="anchor" href="#movenet"></a>
</h1></div>
<p>Movenet is a data digitalisation toolkit being developed by the <a href="https://www.nordforsk.org/projects/digitalisation-livestock-data-improve-veterinary-public-health" class="external-link">NordForsk DigiVet project</a>. It facilitates the dataflow from livestock movement data to social network analysis and disease transmission models, while addressing common data issues such as the diversity of data formats and privacy preservation.</p>
<p>We are also developing an accompanying interactive web app (temporarily housed <a href="https://github.com/digivet-consortium/movenetapp" class="external-link">here</a>) to cater to users who may prefer a graphical user interface.</p>
<p><strong>Disclaimer:</strong> Movenet is under active development. The way functions are called, and the internal methods, may still change without prior warning.</p>
<div class="section level2">
<h2 id="workflows">Workflows<a class="anchor" aria-label="anchor" href="#workflows"></a>
</h2>
<p>Movenet facilitates a range of objectives and workflows pertaining to the processing and analysis of livestock movement data and (optional) holding data: - standardisation into a single format, allowing for interoperability and integration of data from different countries or systems; - pseudonymisation, and a range of options to make the data non-identifiable; - generation of networks, and (basic) social network analysis; - integration of the data into transmission models; - exploration of the effects of different anonymisation options on outcomes of network analyses and transmission models, so as to allow users to find a suitable balance between the scale of anonymisation and the accuracy of these outcomes.</p>
<p>The functionality made available by this package can be divided into four sections: reading in and reformatting data; making data non-identifiable; generation of networks and (basic) social network analysis; and integration of data into transmission models (in progress). The following flow chart illustrates how the key functions in these categories relate to one another and can be used as reference for how this package fits together.</p>
<figure><img src="reference/figures/readme-flowchart.svg" alt="Flow chart split into sections corresponding to the next sections of this document. It shows the general flow of usage of the Movenet package, and how some of the important functions can be used to transform the data. This is covered in more detail in the next sections of this document."><figcaption aria-hidden="true">
Flow chart split into sections corresponding to the next sections of this document. It shows the general flow of usage of the Movenet package, and how some of the important functions can be used to transform the data. This is covered in more detail in the next sections of this document.
</figcaption></figure><p>The remaining sections of this document explain how to use the package in more detail, with code samples. For even more detail, consult the documentation of each function.</p>
</div>
<div class="section level2">
<h2 id="reading-in-and-reformatting-data">Reading in and reformatting data<a class="anchor" aria-label="anchor" href="#reading-in-and-reformatting-data"></a>
</h2>
<p>A first step in any workflow is reading in livestock movement data (and optional holding data). At this stage, the challenge is the diversity of formats that movement and holding data can come in. Movenet addresses this by requiring users to provide a configuration file, indicating appropriate values for a range of factors that commonly vary between datasets, such as the separator and date format used, as well as headers of relevant columns. Example configuration files as well as an empty template are available in the <code>/inst/configurations</code> folder. Using the appropriate configurations, data are read in and converted to a standardised Movenet format. This standardised format focuses on minimally required data (from, to, date, weight) but allows for additional columns; data types for specific columns are checked, and where possible converted to standards (e.g. R Date format) to improve interoperability.</p>
<p>To read in and reformat some data, first we select a configuration. We do this using the <code>load_config(configfile)</code> function. For example, to load the configuration for ScotEID data, we run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The ScotEID configuration is loaded from ScotEID.yml into Movenet's environment.</span></span>
<span><span class="fu"><a href="reference/change_config.html">load_config</a></span><span class="op">(</span><span class="st">"ScotEID"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Successfully loaded config file: ScotEID</span></span></code></pre></div>
<p>Next, we can use the <code>reformat_data(datafile, type)</code> function to read and reformat the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datafile</span> <span class="op">&lt;-</span> <span class="st">"tests/testthat/test_input_files/sample_pigs_UK_with_dep_arr_dates.csv"</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/reformat_data.html">reformat_data</a></span><span class="op">(</span><span class="va">datafile</span>, <span class="st">"movement"</span><span class="op">)</span></span>
<span><span class="co"># Here we are using movement data, but we can also read and reformat holding</span></span>
<span><span class="co"># data if we change the second parameter to "holding".</span></span></code></pre></div>
<p>The reformatted data is returned as a tibble. The columns are in a standardised order.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Look at the first six rows of the tibble</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   departure_cph dest_cph    departure_date qty_pigs movement_reference</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;       &lt;date&gt;            &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 95/216/1100   19/818/9098 2019-02-08           97             304781</span></span>
<span><span class="co">#&gt; 2 69/196/5890   71/939/3228 2019-08-15          167             229759</span></span>
<span><span class="co">#&gt; 3 52/577/5349   82/501/8178 2019-09-15          115              36413</span></span>
<span><span class="co">#&gt; 4 39/103/5541   13/282/1763 2019-10-26          125             488616</span></span>
<span><span class="co">#&gt; 5 41/788/6464   57/418/6011 2019-10-17          109             581785</span></span>
<span><span class="co">#&gt; 6 69/393/9398   39/947/2201 2019-10-06           72             564911</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="making-data-non-identifiable">Making data non-identifiable<a class="anchor" aria-label="anchor" href="#making-data-non-identifiable"></a>
</h2>
<p>To address concerns around commercial sensitivity, Movenet includes a range of functions to make livestock movement data and/or holding data non-identifiable. It can pseudonymise holding identifiers:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pseudonymise our data using the anonymise() function:</span></span>
<span><span class="va">anonymised</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/anonymise.html">anonymise</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"FARM"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">anonymised</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">anonymisation_key</span> <span class="op">&lt;-</span> <span class="va">anonymised</span><span class="op">$</span><span class="va">key</span></span>
<span></span>
<span><span class="co"># Now we can see the data has been pseudonymised:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   departure_cph dest_cph departure_date qty_pigs movement_reference</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;    &lt;date&gt;            &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 FARM132       FARM322  2019-02-08           97             304781</span></span>
<span><span class="co">#&gt; 2 FARM276       FARM496  2019-08-15          167             229759</span></span>
<span><span class="co">#&gt; 3 FARM329       FARM256  2019-09-15          115              36413</span></span>
<span><span class="co">#&gt; 4 FARM334       FARM316  2019-10-26          125             488616</span></span>
<span><span class="co">#&gt; 5 FARM393       FARM430  2019-10-17          109             581785</span></span>
<span><span class="co">#&gt; 6 FARM375       FARM178  2019-10-06           72             564911</span></span>
<span></span>
<span><span class="co"># And if desired, we can keep the anonymisation key to reverse this process later:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">anonymisation_key</span><span class="op">)</span></span>
<span><span class="co">#&gt; 79/642/5562 95/903/2776 86/580/7898 31/473/4857 77/458/3246 52/672/6036 </span></span>
<span><span class="co">#&gt;     "FARM1"     "FARM2"     "FARM3"     "FARM4"     "FARM5"     "FARM6"</span></span>
<span></span>
<span><span class="co"># anonymise() also takes an optional `key` argument to use an existing key</span></span></code></pre></div>
<p>It can also modify dates or weights by applying a small amount of noise or by rounding:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use jitter to coarsen the dates</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">coarsen_date</span><span class="op">(</span></span>
<span>  jitter <span class="op">=</span> <span class="fl">5</span>, <span class="co"># add jitter of ±5 days</span></span>
<span>  rounding_unit <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># do not round the data</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: As 'rounding_unit' is FALSE, no rounding or summarising by date has</span></span>
<span><span class="co">#&gt;     been performed. Arguments 'sum_weight' and '...' have been ignored.</span></span>
<span></span>
<span><span class="co"># Use rounding to coarsen the weights</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">coarsen_weight</span><span class="op">(</span></span>
<span>  round <span class="op">=</span> <span class="fl">10</span>, <span class="co"># round weights to the nearest multiple of 10</span></span>
<span>  jitter <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># do not jitter the data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A function to resample holding coordinates in a density-dependent manner is under development. The envisaged effect is to increase data sharing between different countries or organisations, which is of particular relevance when modelling transboundary disease spread.</p>
</div>
<div class="section level2">
<h2 id="generation-of-networks-and-basic-social-network-analysis">Generation of networks and (basic) social network analysis<a class="anchor" aria-label="anchor" href="#generation-of-networks-and-basic-social-network-analysis"></a>
</h2>
<p>Movenet uses the <a href="https://statnet.org/packages/" class="external-link">Statnet suite of packages</a> (e.g. NetworkDynamic and tsna) for (temporal) social network analysis. We are currently working on functions in this section - e.g. creation of a pdf report with network measures of particular relevance to disease transmission.</p>
<p>Currently it is already possible to generate a NetworkDynamic and perform some kinds of analysis:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a NetworkDynamic from our data</span></span>
<span><span class="va">smallData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span>, n<span class="op">=</span><span class="fl">300</span><span class="op">)</span> <span class="co"># use a subset of our data so this notebook knits faster</span></span>
<span><span class="va">network</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/movedata2networkDynamic.html">movedata2networkDynamic</a></span><span class="op">(</span><span class="va">smallData</span><span class="op">)</span></span>
<span><span class="va">network</span></span>
<span><span class="co">#&gt; NetworkDynamic properties:</span></span>
<span><span class="co">#&gt;   distinct change times: 211 </span></span>
<span><span class="co">#&gt;   maximal time range: 17898 until  18257 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Dynamic (TEA) attributes:</span></span>
<span><span class="co">#&gt;   Edge TEAs:    movement_reference.active </span></span>
<span><span class="co">#&gt;      qty_pigs.active </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Includes optional net.obs.period attribute:</span></span>
<span><span class="co">#&gt;  Network observation period info:</span></span>
<span><span class="co">#&gt;   Number of observation spells: 1 </span></span>
<span><span class="co">#&gt;   Maximal time range observed: 17898 until 18257 </span></span>
<span><span class="co">#&gt;   Temporal mode: continuous </span></span>
<span><span class="co">#&gt;   Time unit: unknown </span></span>
<span><span class="co">#&gt;   Suggested time increment: NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Network attributes:</span></span>
<span><span class="co">#&gt;   vertices = 364 </span></span>
<span><span class="co">#&gt;   directed = TRUE </span></span>
<span><span class="co">#&gt;   hyper = FALSE </span></span>
<span><span class="co">#&gt;   loops = FALSE </span></span>
<span><span class="co">#&gt;   multiple = FALSE </span></span>
<span><span class="co">#&gt;   bipartite = FALSE </span></span>
<span><span class="co">#&gt;   net.obs.period: (not shown)</span></span>
<span><span class="co">#&gt;   vertex.pid = true_id </span></span>
<span><span class="co">#&gt;   total edges= 300 </span></span>
<span><span class="co">#&gt;     missing edges= 0 </span></span>
<span><span class="co">#&gt;     non-missing edges= 300 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Vertex attribute names: </span></span>
<span><span class="co">#&gt;     active true_id vertex.names </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Edge attribute names: </span></span>
<span><span class="co">#&gt;     active movement_reference.active qty_pigs.active</span></span>
<span></span>
<span><span class="co"># Perform some analysis - find the max reachability</span></span>
<span><span class="fu"><a href="reference/parallel_max_reachabilities.html">parallel_max_reachabilities</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span>, n_threads<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="integration-of-data-into-transmission-models">Integration of data into transmission models<a class="anchor" aria-label="anchor" href="#integration-of-data-into-transmission-models"></a>
</h2>
<p>Movenet links up with <a href="https://github.com/stewid/SimInf" class="external-link">SimInf</a> for transmission modelling. We are currently working on functions in this section.</p>
<p>(A more extensive summary and usage/example code will be added shortly.)</p>
</div>
<div class="section level2">
<h2 id="setting-a-default-configuration">Setting a Default Configuration<a class="anchor" aria-label="anchor" href="#setting-a-default-configuration"></a>
</h2>
<p>If you use Movenet with the same configuration most or all of the time, you may want to have Movenet automatically load a configuration file when the Movenet package is loaded.</p>
<p>To do this, you should find the <code>movenet/R</code> directory (where all of the package’s code is located). Create a file in this directory called <code>zzz.R</code>. In this file, type the following code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.onLoad</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">libname</span>, <span class="va">pkgname</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/change_config.html">load_config</a></span><span class="op">(</span><span class="st">"ScotEID"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>where <code>ScotEID</code> can be replaced with whatever configuration you wish to load. Now, whenever the Movenet package is loaded, this <code>.onLoad</code> function will be called, loading the desired configuration. See <a href="https://r-pkgs.org/Code.html#sec-code-onLoad-onAttach" class="external-link">this page</a> for more information on <code>.onLoad</code> and zzz.R.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing movenet</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matt Denwood <br><small class="roles"> Author, maintainer </small>  </li>
<li>Carlijn Bogaardt <br><small class="roles"> Author </small>  </li>
<li>Stefan Widgren <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-5745-2284" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Denwood, Carlijn Bogaardt, Stefan Widgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
